#V2
-- Define Knowledge Item table
DEFINE TABLE knowledge_item SCHEMAFULL;
DEFINE FIELD id ON knowledge_item TYPE string;
DEFINE FIELD title ON knowledge_item TYPE string;
DEFINE FIELD content ON knowledge_item TYPE string;
DEFINE FIELD content_type ON knowledge_item TYPE string;
DEFINE FIELD metadata ON knowledge_item TYPE object;
DEFINE FIELD tags ON knowledge_item TYPE array;
DEFINE FIELD embedding_id ON knowledge_item TYPE string;
DEFINE FIELD created_at ON knowledge_item TYPE datetime;
DEFINE FIELD updated_at ON knowledge_item TYPE datetime;
DEFINE FIELD version ON knowledge_item TYPE int;
DEFINE FIELD source ON knowledge_item TYPE string;
-- Define indexes for knowledge_item
DEFINE INDEX knowledge_item_title ON knowledge_item FIELDS title;
DEFINE INDEX knowledge_item_tags ON knowledge_item FIELDS tags;
DEFINE INDEX knowledge_item_content_type ON knowledge_item FIELDS content_type;
DEFINE INDEX knowledge_item_created_at ON knowledge_item FIELDS created_at;
DEFINE INDEX knowledge_item_updated_at ON knowledge_item FIELDS updated_at;
DEFINE INDEX knowledge_item_embedding_id ON knowledge_item FIELDS embedding_id;
-- Define Embedding table
DEFINE TABLE embedding SCHEMAFULL;
DEFINE FIELD id ON embedding TYPE string;
DEFINE FIELD vector ON embedding TYPE array<float>;
DEFINE FIELD model ON embedding TYPE string;
DEFINE FIELD dimensions ON embedding TYPE int;
DEFINE FIELD item_id ON embedding TYPE string;
DEFINE FIELD created_at ON embedding TYPE datetime;
-- Define indexes for embedding
DEFINE INDEX embedding_item_id ON embedding FIELDS item_id;
DEFINE INDEX embedding_model ON embedding FIELDS model;
-- Define vector index for similarity search
-- Using HNSW index for fast approximate nearest neighbors
DEFINE INDEX vector_index_hnsw ON embedding 
-- Use the specified namespace and database
USE NAMESPACE ptolemies;
USE DATABASE knowledge;
-- Create admin user table if it doesn't exist
DEFINE TABLE admin_user SCHEMAFULL;
DEFINE FIELD username ON admin_user TYPE string;
DEFINE FIELD password ON admin_user TYPE string;
DEFINE FIELD created_at ON admin_user TYPE datetime;
DEFINE FIELD role ON admin_user TYPE string;
-- Check if admin user already exists
-- Define the namespace and database
DEFINE NAMESPACE ptolemies;
USE NAMESPACE ptolemies;
DEFINE DATABASE knowledge;
USE DATABASE knowledge;
-- Output confirmation message
-- Use the specified namespace and database
USE NAMESPACE ptolemies;
USE DATABASE knowledge;
-- Set dimension and distance metric for vector operations
LET $dimensions = 1536;
LET $distance_metric = 'cosine';
-- Define Knowledge Item table
DEFINE TABLE knowledge_item SCHEMAFULL;
DEFINE FIELD id ON knowledge_item TYPE string;
DEFINE FIELD title ON knowledge_item TYPE string;
DEFINE FIELD content ON knowledge_item TYPE string;
DEFINE FIELD content_type ON knowledge_item TYPE string;
DEFINE FIELD metadata ON knowledge_item TYPE object;
DEFINE FIELD tags ON knowledge_item TYPE array;
DEFINE FIELD embedding_id ON knowledge_item TYPE string;
DEFINE FIELD created_at ON knowledge_item TYPE datetime;
DEFINE FIELD updated_at ON knowledge_item TYPE datetime;
DEFINE FIELD version ON knowledge_item TYPE int;
DEFINE FIELD source ON knowledge_item TYPE string;
-- Define indexes for knowledge_item
DEFINE INDEX knowledge_item_title ON knowledge_item FIELDS title;
DEFINE INDEX knowledge_item_tags ON knowledge_item FIELDS tags;
DEFINE INDEX knowledge_item_content_type ON knowledge_item FIELDS content_type;
DEFINE INDEX knowledge_item_created_at ON knowledge_item FIELDS created_at;
DEFINE INDEX knowledge_item_updated_at ON knowledge_item FIELDS updated_at;
DEFINE INDEX knowledge_item_embedding_id ON knowledge_item FIELDS embedding_id;
-- Define Embedding table
DEFINE TABLE embedding SCHEMAFULL;
DEFINE FIELD id ON embedding TYPE string;
DEFINE FIELD vector ON embedding TYPE array<float>;
DEFINE FIELD model ON embedding TYPE string;
DEFINE FIELD dimensions ON embedding TYPE int;
DEFINE FIELD item_id ON embedding TYPE string;
DEFINE FIELD created_at ON embedding TYPE datetime;
-- Define indexes for embedding
DEFINE INDEX embedding_item_id ON embedding FIELDS item_id;
DEFINE INDEX embedding_model ON embedding FIELDS model;
-- Define vector index for similarity search
-- Using HNSW index for fast approximate nearest neighbors
DEFINE INDEX vector_index_hnsw ON embedding 
-- Use the specified namespace and database
USE NAMESPACE ptolemies;
USE DATABASE knowledge;
-- Create admin user table if it doesn't exist
DEFINE TABLE admin_user SCHEMAFULL;
DEFINE FIELD username ON admin_user TYPE string;
DEFINE FIELD password ON admin_user TYPE string;
DEFINE FIELD created_at ON admin_user TYPE datetime;
DEFINE FIELD role ON admin_user TYPE string;
-- Check if admin user already exists
